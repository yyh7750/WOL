<UserControl x:Class="WOL.View.DeviceView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:WOL.View"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="800">
    <StackPanel>
        <!-- 디바이스 헤더 -->
        <Grid Margin="0,0,0,24">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock Grid.Column="0" Style="{StaticResource Heading3}" Text="디바이스 및 프로그램 목록" />
            <Button Grid.Column="1" Command="{Binding AddDeviceCommand}" Content="디바이스 추가" Style="{StaticResource SuccessButton}" />
        </Grid>

        <!-- 디바이스 목록 -->
        <ItemsControl ItemsSource="{Binding Devices}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border Margin="0,0,0,16" Style="{StaticResource CardStyle}">
                        <StackPanel>
                            <!-- 디바이스 정보 및 제어 버튼 -->
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Style="{StaticResource Heading3}" Text="{Binding Name}" />
                                    <TextBlock Margin="0,4,0,0" Style="{StaticResource BodyText}" Text="{Binding IP}" />
                                    <TextBlock Margin="0,2,0,0" Style="{StaticResource CaptionText}" Text="{Binding MAC}" />
                                </StackPanel>

                                <Border Grid.Column="1" Margin="0,0,10,0" Padding="8,4" Background="{Binding Status, Converter={StaticResource StatusColorConverter}}" CornerRadius="12" VerticalAlignment="Center">
                                    <TextBlock FontSize="12" FontWeight="Medium" Foreground="{StaticResource White}" Text="{Binding Status}" />
                                </Border>

                                <Button Grid.Column="2" Margin="0,0,8,0" Command="{Binding DataContext.ProgramViewModel.AddProgramCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" Content="프로그램 추가" Style="{StaticResource PrimaryButton}" />
                                <Button Grid.Column="3" Margin="0,0,8,0" Command="{Binding DataContext.UpdateDeviceCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Content="수정" Style="{StaticResource WarningButton}" />
                                <Button Grid.Column="4" Command="{Binding DataContext.DeleteDeviceCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Content="삭제" Style="{StaticResource DangerButton}" />
                            </Grid>

                            <!-- 해당 디바이스의 프로그램 목록 -->
                            <local:ProgramView DataContext="{Binding}" />
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </StackPanel>
</UserControl>